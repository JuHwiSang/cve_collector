from __future__ import annotations

from ..domain.models import Vulnerability
from ..ports.enrich_port import VulnerabilityEnrichmentPort
from ..ports.index_port import VulnerabilityIndexPort


class DetailVulnerabilityUseCase:
    def __init__(self, index: VulnerabilityIndexPort, enricher: VulnerabilityEnrichmentPort | None = None) -> None:
        self._index = index
        self._enricher = enricher

    def execute(self, selector: str) -> Vulnerability | None:
        v = self._index.get(selector)
        if v is None:
            return None
        if self._enricher is None:
            return v
        return self._enricher.enrich(v)


